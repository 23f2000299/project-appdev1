{% extends 'base.html' %}
{% block title %}Manage Questions{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2>Questions for Quiz ID: {{ quiz.id }}</h2>
  
  <!-- List all questions -->
  <ul class="list-group mb-3">
    {% for q in questions %}
      <li class="list-group-item">
        <strong>{{ q.question_statement }}</strong>
        <ol>
          <li>{{ q.option1 }}</li>
          <li>{{ q.option2 }}</li>
          <li>{{ q.option3 }}</li>
          <li>{{ q.option4 }}</li>
        </ol>
        <p>Correct Option: {{ q.correct_option }}</p>
        <div>
          <!-- Inline Edit Link -->
          <a href="#edit-question-{{ q.id }}" class="btn btn-sm btn-secondary mr-2">Edit</a>
          <!-- Delete Form -->
          <form method="POST" action="{{ url_for('delete_question', question_id=q.id) }}" style="display:inline;">
            <button type="submit" class="btn btn-sm btn-danger">Delete</button>
          </form>
        </div>
      </li>

      <!-- Inline Edit Form for this question, hidden by default (use :target in CSS) -->
      <div id="edit-question-{{ q.id }}" class="edit-form">
        <form method="POST" action="{{ url_for('edit_question', question_id=q.id) }}">
          <div class="form-group">
            <label>Question Statement</label>
            <textarea 
              name="question_statement" 
              class="form-control mb-2" 
              rows="3" 
              required
            >{{ q.question_statement }}</textarea>
          </div>
          <div class="form-group">
            <label>Option 1</label>
            <input 
              type="text" 
              name="option1" 
              class="form-control mb-2" 
              value="{{ q.option1 }}" 
              required
            >
          </div>
          <div class="form-group">
            <label>Option 2</label>
            <input 
              type="text" 
              name="option2" 
              class="form-control mb-2" 
              value="{{ q.option2 }}" 
              required
            >
          </div>
          <div class="form-group">
            <label>Option 3</label>
            <input 
              type="text" 
              name="option3" 
              class="form-control mb-2" 
              value="{{ q.option3 }}" 
              required
            >
          </div>
          <div class="form-group">
            <label>Option 4</label>
            <input 
              type="text" 
              name="option4" 
              class="form-control mb-2" 
              value="{{ q.option4 }}" 
              required
            >
          </div>
          <div class="form-group">
            <label>Correct Option (1-4)</label>
            <input 
              type="number" 
              name="correct_option" 
              class="form-control mb-2" 
              value="{{ q.correct_option }}" 
              min="1" 
              max="4" 
              required
            >
          </div>
          <button type="submit" class="btn btn-primary btn-sm">Save Changes</button>
          <!-- Cancel link to remove #edit-question-... fragment -->
          <a href="#close" class="btn btn-link btn-sm">Cancel</a>
        </form>
      </div>
    {% else %}
      <li class="list-group-item">No questions available.</li>
    {% endfor %}
  </ul>

  <!-- Add Question Form -->
  <h4>Add New Question</h4>
  <form method="POST" action="{{ url_for('add_question', quiz_id=quiz.id) }}">
    <div class="form-group">
      <label>Question Statement</label>
      <textarea 
        name="question_statement" 
        class="form-control mb-2" 
        rows="3" 
        required
      ></textarea>
    </div>
    <div class="form-group">
      <label>Option 1</label>
      <input type="text" name="option1" class="form-control mb-2" required>
    </div>
    <div class="form-group">
      <label>Option 2</label>
      <input type="text" name="option2" class="form-control mb-2" required>
    </div>
    <div class="form-group">
      <label>Option 3</label>
      <input type="text" name="option3" class="form-control mb-2" required>
    </div>
    <div class="form-group">
      <label>Option 4</label>
      <input type="text" name="option4" class="form-control mb-2" required>
    </div>
    <div class="form-group">
      <label>Correct Option (1-4)</label>
      <input 
        type="number" 
        name="correct_option" 
        class="form-control mb-2" 
        min="1" 
        max="4" 
        required
      >
    </div>
    <button type="submit" class="btn btn-success">Add Question</button>
  </form>

  <!-- Back to Quizzes -->
  <a href="{{ url_for('admin_quiz_overview') }}" class="btn btn-secondary mt-3">Back to Quiz Overview</a>
</div>
{% endblock %}
