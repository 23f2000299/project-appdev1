{% extends 'base.html' %}
{% block title %}Admin Search{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2>Admin Search</h2>
  <form method="GET" action="{{ url_for('admin_search') }}" class="form-inline my-2 my-lg-0">
    <input class="form-control mr-sm-2" type="search" name="q" placeholder="Search..." aria-label="Search" value="{{ query }}">
    <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
  </form>

  {% if query %}
    <p class="mt-3">Results for "<strong>{{ query }}</strong>":</p>
  {% endif %}

  {% if results %}
    <!-- Users -->
    <h4>Users</h4>
    {% if results.users %}
      <ul class="list-group mb-3">
        {% for user in results.users %}
          <li class="list-group-item">{{ user.username }} - {{ user.full_name }}</li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No users found.</p>
    {% endif %}

    <!-- Subjects -->
    <h4>Subjects</h4>
    {% if results.subjects %}
      <ul class="list-group mb-3">
        {% for subject in results.subjects %}
          <li class="list-group-item">{{ subject.name }} - {{ subject.description }}</li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No subjects found.</p>
    {% endif %}

    <!-- Quizzes -->
    <h4>Quizzes</h4>
    {% if results.quizzes %}
      <ul class="list-group mb-3">
        {% for quiz in results.quizzes %}
          <li class="list-group-item">
            Quiz ID: {{ quiz.id }} - Remarks: {{ quiz.remarks }}
            <br>
            Subject: {{ quiz.chapter.subject.name }} | Chapter: {{ quiz.chapter.name }}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No quizzes found.</p>
    {% endif %}

    <!-- Questions -->
    <h4>Questions</h4>
    {% if results.questions %}
      <ul class="list-group mb-3">
        {% for question in results.questions %}
          <li class="list-group-item">
            {{ question.question_statement[:50] }}...
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No questions found.</p>
    {% endif %}
  {% elif query %}
    <p>No results found for "{{ query }}".</p>
  {% endif %}
</div>
{% endblock %}
